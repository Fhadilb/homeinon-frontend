<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HomeInOn</title>
  <style>
    :root {
      --brand-accent: #F4A27B;  /* Coral */
      --brand-bg: #FFF8F5;      /* Soft background */
      --ink: #2C2C2C;           /* Text */
      --muted: #6B6B6B;
      --card: #FFFFFF;
      --ring: rgba(244,162,123,.55);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Arial", sans-serif;
      background: var(--brand-bg);
      color: var(--ink);
    }

    /* Sticky header - includes logo, filters, and style cards */
    header {
      position: sticky;
      top: 0;
      z-index: 999;
      background: var(--card);
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      padding-bottom: 10px;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background: var(--card);
    }

    .logo img {
      height: 60px;
      width: auto;
      object-fit: contain;
    }

    button {
      background: var(--brand-accent);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
      cursor: pointer;
      font-weight: bold;
      transition: background .2s;
    }

    button:hover { background: #e18f6a; }

    /* Filters */
    #filterToggle {
      display: none;
      width: 100%;
      background: var(--brand-accent);
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      font-weight: bold;
    }

    .filters {
      display: grid;
      grid-template-columns: repeat(5, minmax(160px, 1fr));
      gap: 16px;
      background: var(--card);
      padding: 10px 20px;
      border-top: 1px solid #eee;
    }

    .filter-group { display: flex; flex-direction: column; gap: 6px; }
    .filter-group label { font-size: 0.9rem; color: var(--muted); }
    .filter-group input,
    .filter-group select,
    .filter-group input[type="range"] {
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 1rem;
    }
    .range-row { display: flex; align-items: center; gap: 10px; }
    .muted { color: var(--muted); font-size: .9rem; }

    /* Colour swatches */
    .swatches { display: flex; flex-wrap: wrap; gap: 8px; }
    .swatch {
      --sz: 26px;
      width: var(--sz);
      height: var(--sz);
      border-radius: 50%;
      border: 1px solid rgba(0,0,0,0.15);
      cursor: pointer;
      outline: 2px solid transparent;
      outline-offset: 2px;
    }
    .swatch[data-selected="true"] { outline: 3px solid var(--ring); }

    /* Style cards */
    .styles {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding: 10px 20px;
      background: var(--card);
    }

    .style-card {
      min-width: 130px;
      height: 110px;
      border-radius: 10px;
      overflow: hidden;
      position: relative;
      cursor: pointer;
      border: 2px solid transparent;
      flex: 0 0 auto;
      transition: transform .2s, border .2s;
    }

    .style-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .style-card span {
      position: absolute;
      bottom: 5px;
      left: 0; right: 0;
      text-align: center;
      color: white;
      font-weight: bold;
      text-shadow: 0 0 4px rgba(0,0,0,0.8);
      background: rgba(0,0,0,0.25);
    }

    .style-card.active { border: 2px solid var(--brand-accent); transform: scale(1.05); }

    /* Product grid */
    #product-count {
      margin: 15px 20px 10px;
      font-weight: bold;
    }

    #product-list {
      display: grid;
      gap: 20px;
      padding: 0 20px 30px;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    }

    .product {
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 8px rgba(0,0,0,0.08);
      overflow: hidden;
      position: relative;
      transition: transform .2s;
    }

    .product:hover { transform: translateY(-4px); }

    .product img {
      width: 100%;
      height: 240px;
      object-fit: cover;
    }

    .style-label {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--brand-accent);
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: bold;
    }

    .product-info {
      padding: 12px;
    }

    .price {
      font-weight: 700;
      color: var(--brand-accent);
    }

    /* Mobile */
    @media (max-width: 768px) {
      header { position: static; }
      .filters { display: none; grid-template-columns: 1fr; }
      .filters.active { display: grid; }
      #filterToggle { display: block; }
      .styles { padding: 10px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="top-bar">
      <div class="logo"><img src="Home-in-on-logo.webp" alt="HomeInOn Logo"></div>
      <button id="toggleFavourites">⭐ View Favourites</button>
    </div>

    <div class="styles" id="styleSelector"></div>

    <button id="filterToggle">Show Filters ⬇️</button>

    <section class="filters" id="filters">
      <div class="filter-group">
        <label for="searchBox">Search</label>
        <input type="text" id="searchBox" placeholder="e.g. oak table, mirror, sofa…"/>
      </div>

      <div class="filter-group">
        <label for="category">Category</label>
        <select id="category"><option value="">All</option></select>
      </div>

      <div class="filter-group">
        <label for="material">Material</label>
        <select id="material"><option value="">All</option></select>
      </div>

      <div class="filter-group">
        <label for="priceRange">Max Price (£)</label>
        <div class="range-row">
          <input type="range" id="priceRange" min="0" max="2000" step="10" value="2000"/>
          <span class="muted" id="priceValue">£2000</span>
        </div>
      </div>

      <div class="filter-group" style="grid-column:1 / -1;">
        <label>Colour</label>
        <div id="colourSwatches" class="swatches"></div>
      </div>
    </section>
  </header>

  <p id="product-count"></p>
  <div id="product-list"></div>

  <script>
    const API_URL = "https://homeinon-backend.onrender.com/products";
    const STYLE_IMAGES = {
      "modern": "style-modern.jpg",
      "boho": "style-boho.jpg",
      "scandi": "style-scandi.jpg",
      "industrial": "style-industrial.jpg"
    };

    let allProducts = [];
    let favourites = JSON.parse(localStorage.getItem("favourites") || "[]");
    let selectedColours = new Set();
    let selectedStyle = "";

    const colourMap = {
      white:"#ffffff", black:"#000000", grey:"#9e9e9e", oak:"#c49a6c",
      walnut:"#7a5734", pine:"#d5b887", beige:"#d9c7a2", gold:"#c8a951",
      silver:"#bdbdbd", blue:"#5a7abf", green:"#6aa67a", red:"#c74c4c"
    };
    const colourHex = n => (n && colourMap[String(n).toLowerCase()]) || "#ccc";

    function uniqueValues(items, field) {
      const set = new Set();
      items.forEach(p => {
        const val = p[field];
        if (val) String(val).split(/[,/|;]/).forEach(v => set.add(v.trim()));
      });
      return [...set].filter(Boolean);
    }

    function buildColourSwatches(colours) {
      const box = document.getElementById("colourSwatches");
      box.innerHTML = "";
      colours.forEach(col => {
        const label = document.createElement("label");
        label.className = "swatch";
        label.style.background = colourHex(col);
        const input = document.createElement("input");
        input.type = "checkbox";
        input.value = col;
        input.addEventListener("change", () => {
          if (input.checked) selectedColours.add(col);
          else selectedColours.delete(col);
          applyFilters();
        });
        label.appendChild(input);
        box.appendChild(label);
      });
    }

    function populateSelect(id, values) {
      const el = document.getElementById(id);
      el.innerHTML = '<option value="">All</option>';
      values.sort().forEach(v => {
        const opt = document.createElement("option");
        opt.value = v;
        opt.textContent = v;
        el.appendChild(opt);
      });
    }

    function buildStyleCards(styles) {
      const row = document.getElementById("styleSelector");
      row.innerHTML = "";
      styles.forEach(style => {
        const card = document.createElement("div");
        card.className = "style-card";
        const imgSrc = STYLE_IMAGES[style.toLowerCase()] || `https://placehold.co/200x150?text=${encodeURIComponent(style)}`;
        card.innerHTML = `<img src="${imgSrc}" alt="${style}"><span>${style}</span>`;
        card.addEventListener("click", () => {
          document.querySelectorAll(".style-card").forEach(c => c.classList.remove("active"));
          if (selectedStyle === style) selectedStyle = "";
          else { selectedStyle = style; card.classList.add("active"); }
          applyFilters();
        });
        row.appendChild(card);
      });
    }

    function renderProducts(products) {
      const list = document.getElementById("product-list");
      const count = document.getElementById("product-count");
      list.innerHTML = "";
      count.textContent = `${products.length} product${products.length!==1?"s":""} found`;
      products.forEach(p => {
        const card = document.createElement("div");
        card.className = "product";
        const price = parseFloat(p.price) || 0;
        card.innerHTML = `
          <div class="style-label">${p.style || ""}</div>
          <img src="${p.image_url}" alt="${p.title}" onerror="this.src='https://placehold.co/320x240?text=No+Image'"/>
          <div class="product-info">
            <h3>${p.title}</h3>
            <p class="price">£${price.toFixed(2)}</p>
          </div>
        `;
        list.appendChild(card);
      });
    }

    function applyFilters() {
      const q = document.getElementById("searchBox").value.toLowerCase();
      const cat = document.getElementById("category").value;
      const mat = document.getElementById("material").value;
      const max = parseFloat(document.getElementById("priceRange").value) || Infinity;
      const filtered = allProducts.filter(p => {
        const title = (p.title||"").toLowerCase();
        const desc = (p.description||"").toLowerCase();
        const searchOK = !q || title.includes(q) || desc.includes(q);
        const catOK = !cat || p.category === cat;
        const matOK = !mat || p.material === mat;
        const styleOK = !selectedStyle || p.style === selectedStyle;
        const pr = parseFloat(p.price) || 0;
        const priceOK = pr <= max;
        const colours = String(p.colour||"").split(/[,/|;]/).map(x=>x.trim());
        const colourOK = selectedColours.size===0 || colours.some(c => selectedColours.has(c));
        return searchOK && catOK && matOK && styleOK && colourOK && priceOK;
      });
      renderProducts(filtered);
    }

    async function loadProducts() {
      const res = await fetch(API_URL);
      const data = await res.json();
      allProducts = data.products || [];
      populateSelect("category", uniqueValues(allProducts, "category"));
      populateSelect("material", uniqueValues(allProducts, "material"));
      buildColourSwatches(uniqueValues(allProducts, "colour"));
      buildStyleCards(uniqueValues(allProducts, "style"));
      renderProducts(allProducts);
    }

    document.getElementById("filterToggle").addEventListener("click", () => {
      const f = document.getElementById("filters");
      f.classList.toggle("active");
      document.getElementById("filterToggle").textContent = f.classList.contains("active") ? "Hide Filters ▲" : "Show Filters ⬇️";
    });

    document.getElementById("searchBox").addEventListener("input", applyFilters);
    document.getElementById("category").addEventListener("change", applyFilters);
    document.getElementById("material").addEventListener("change", applyFilters);
    document.getElementById("priceRange").addEventListener("input", e => {
      document.getElementById("priceValue").textContent = `£${e.target.value}`;
      applyFilters();
    });

    loadProducts();
  </script>
</body>
</html>





