<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HomeInOn</title>
  <style>
    :root{
      --brand-accent:#f4a27b;
      --ink:#333;
      --muted:#777;
      --card:#fff;
      --bg:#fafafa;
      --ring: rgba(244,162,123,.55);
    }
    *{box-sizing:border-box;}
    body{font-family: Arial, sans-serif; background:var(--bg); color:var(--ink); margin:0;}

    /* Top bar */
    .top-bar{
      position: sticky; top:0; z-index:1000;
      background:#fff; box-shadow:0 2px 5px rgba(0,0,0,.08);
      padding:10px 20px; display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap;
    }
    .logo{display:flex; align-items:center; font-family: Georgia, serif; font-size:2rem; font-weight:bold;}
    .logo span{position:relative; z-index:1;}
    .logo .in{position:relative; padding:0 8px;}
    .logo .in::before{
      content:""; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
      width:70px; height:70px; background:var(--brand-accent); border-radius:50%; z-index:-1; filter:blur(.3px);
    }
    button{background:#333;color:#fff;border:none;border-radius:8px;padding:8px 14px;cursor:pointer;transition:.2s;}
    button:hover{background:#555;}

    /* Style cards */
    .styles{display:flex; gap:15px; margin:15px 20px; flex-wrap:wrap;}
    .style-card{
      width:120px; height:120px; border-radius:12px; overflow:hidden; cursor:pointer; position:relative;
      border:2px solid transparent; transition:transform .2s, border .2s;
      background:#eee; display:flex; align-items:center; justify-content:center;
    }
    .style-card span{
      position:absolute; bottom:5px; left:0; right:0; text-align:center; color:#fff;
      font-weight:bold; text-shadow:0 0 5px rgba(0,0,0,.7); background:rgba(0,0,0,.25);
    }
    .style-card.active{border:2px solid var(--brand-accent); transform:scale(1.05);}
    .style-card:hover{transform:scale(1.05);}

    /* Filters */
    #filterToggle{display:none; width:100%; background:var(--brand-accent); border-radius:0; margin:0; font-weight:bold;}
    .filters{
      background:var(--card); margin:12px 20px; padding:14px; border-radius:12px;
      box-shadow:0 2px 8px rgba(0,0,0,.06);
      display:grid; grid-template-columns: repeat(5, minmax(160px,1fr)); gap:16px;
    }
    .filter-group{display:flex; flex-direction:column; gap:6px;}
    .filter-group label{font-size:.9rem; color:var(--muted);}
    .filter-group input[type="text"],
    .filter-group select,
    .filter-group input[type="range"]{
      padding:8px;border-radius:8px;border:1px solid #ddd;font-size:1rem;background:#fff;
    }
    .range-row{display:flex; align-items:center; gap:10px;}
    .muted{color:var(--muted); font-size:.9rem;}

    /* Colour swatches */
    .swatches{display:flex; flex-wrap:wrap; gap:8px;}
    .swatch{
      --sz:28px; width:var(--sz); height:var(--sz); border-radius:999px; border:1px solid rgba(0,0,0,.15);
      cursor:pointer; outline:2px solid transparent; outline-offset:2px;
    }
    .swatch[data-selected="true"]{outline:3px solid var(--ring);}
    .swatch input{display:none;}

    /* Product grid */
    #product-count{margin:0 20px 6px; font-weight:bold;}
    #product-list{
      display:grid; gap:20px; padding:0 20px 30px;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    }
    @keyframes fadeIn{from{opacity:0; transform:translateY(4px);} to{opacity:1; transform:none;}}
    .product{
      background:#fff; border-radius:12px; box-shadow:0 1px 8px rgba(0,0,0,.08);
      padding:14px; position:relative; display:flex; flex-direction:column; animation:fadeIn .25s ease;
    }
    .product img{width:100%; height:240px; object-fit:cover; border-radius:10px; margin-bottom:10px; background:#eee;}
    .price{font-weight:700;}
    .heart-btn{position:absolute; right:12px; bottom:12px; font-size:22px; color:#bbb; background:none; border:none; cursor:pointer; transition:.18s;}
    .heart-btn.liked{color:#e63946; transform:scale(1.12);}

    /* Mobile adjustments */
    @media(max-width:768px){
      .top-bar{position:static; padding:10px 14px;}
      #filterToggle{display:block;}
      .filters{display:none; grid-template-columns:1fr; margin:10px 12px;}
      .filters.active{display:grid;}
      .styles{justify-content:center;}
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <div class="logo"><span>home</span><span class="in">in</span><span>on</span></div>
    <button id="toggleFavourites">‚≠ê View Favourites</button>
  </div>

  <div class="styles" id="styleSelector"></div>

  <button id="filterToggle">Show Filters ‚¨áÔ∏è</button>

  <section class="filters" id="filters">
    <div class="filter-group">
      <label for="searchBox">Search (name + description)</label>
      <input type="text" id="searchBox" placeholder="e.g. oak table, mirror, sofa‚Ä¶"/>
    </div>

    <div class="filter-group">
      <label for="category">Category</label>
      <select id="category"><option value="">All</option></select>
    </div>

    <div class="filter-group">
      <label for="material">Material</label>
      <select id="material"><option value="">All</option></select>
    </div>

    <div class="filter-group">
      <label for="priceRange">Max Price (¬£)</label>
      <div class="range-row">
        <input type="range" id="priceRange" min="0" max="2000" step="10" value="2000"/>
        <span class="muted" id="priceValue">¬£2000</span>
      </div>
    </div>

    <div class="filter-group" style="grid-column: 1 / -1;">
      <label>Colour</label>
      <div id="colourSwatches" class="swatches"></div>
    </div>
  </section>

  <p id="product-count"></p>
  <div id="product-list"></div>

  <script>
    const API_URL = "https://homeinon-backend.onrender.com/products";
    let allProducts = [];
    let favourites = JSON.parse(localStorage.getItem("favourites") || "[]");
    let selectedColours = new Set();
    let selectedStyle = "";

    const colourMap = {
      white:"#ffffff", black:"#000000", grey:"#9e9e9e", gray:"#9e9e9e",
      oak:"#c49a6c", walnut:"#7a5734", pine:"#d5b887", beech:"#d8b094",
      natural:"#d6c19a", cream:"#f3e9d2", beige:"#d9c7a2", brown:"#8b5a2b",
      gold:"#c8a951", silver:"#bdbdbd", chrome:"#bfbfbf",
      blue:"#5a7abf", green:"#6aa67a", red:"#c74c4c", yellow:"#ebcb56",
      pink:"#e6a3b0", purple:"#9b6bb3", orange:"#e79a42"
    };

    function colourToHex(name){
      if(!name) return "#c9c9c9";
      return colourMap[name.toLowerCase()] || "#c9c9c9";
    }

    function uniqueValues(items, field){
      const set = new Set();
      items.forEach(p=>{
        const val = p[field];
        if(!val) return;
        String(val).split(/[,/|;]/).forEach(v=>set.add(v.trim()));
      });
      return Array.from(set).filter(Boolean);
    }

    function buildColourSwatches(colours){
      const box=document.getElementById("colourSwatches");
      box.innerHTML="";
      colours.forEach(col=>{
        const label=document.createElement("label");
        label.className="swatch";
        label.style.background=colourToHex(col);
        label.dataset.selected="false";
        const input=document.createElement("input");
        input.type="checkbox";
        input.value=col;
        input.addEventListener("change",()=>{
          if(input.checked){selectedColours.add(col); label.dataset.selected="true";}
          else{selectedColours.delete(col); label.dataset.selected="false";}
          applyFilters();
        });
        label.appendChild(input);
        box.appendChild(label);
      });
    }

    function populateSelect(id, values){
      const el=document.getElementById(id);
      el.innerHTML='<option value="">All</option>';
      values.sort().forEach(v=>{
        const opt=document.createElement("option");
        opt.value=v; opt.textContent=v;
        el.appendChild(opt);
      });
    }

    function buildStyleCards(styles){
      const container=document.getElementById("styleSelector");
      container.innerHTML="";
      styles.sort().forEach(style=>{
        const div=document.createElement("div");
        div.className="style-card";
        div.innerHTML=`<span>${style}</span>`;
        div.addEventListener("click",()=>{
          document.querySelectorAll(".style-card").forEach(c=>c.classList.remove("active"));
          if(selectedStyle===style){selectedStyle="";}
          else{selectedStyle=style; div.classList.add("active");}
          applyFilters();
        });
        container.appendChild(div);
      });
    }

    function renderProducts(products){
      const list=document.getElementById("product-list");
      const counter=document.getElementById("product-count");
      list.innerHTML="";
      counter.textContent=`${products.length} product${products.length!==1?"s":""} found`;

      products.forEach(p=>{
        const isLiked=favourites.includes(p.title);
        const card=document.createElement("div");
        card.className="product";
        const priceVal=parseFloat(p.price);
        const displayPrice=isFinite(priceVal)?`¬£${priceVal.toFixed(2)}`:"¬£0.00";
        card.innerHTML=`
          <img src="${p.image_url}" alt="${p.title}" onerror="this.src='https://placehold.co/640x480?text=No+Image'">
          <h3>${p.title}</h3>
          <p class="price">${displayPrice}</p>
          <button class="heart-btn ${isLiked?"liked":""}" data-title="${p.title}">‚ù§</button>
        `;
        list.appendChild(card);
      });

      document.querySelectorAll(".heart-btn").forEach(btn=>{
        btn.addEventListener("click",()=>{
          const title=btn.dataset.title;
          const idx=favourites.indexOf(title);
          if(idx>=0){favourites.splice(idx,1); btn.classList.remove("liked");}
          else{favourites.push(title); btn.classList.add("liked");}
          localStorage.setItem("favourites",JSON.stringify(favourites));
        });
      });
    }

    function applyFilters(){
      const q=document.getElementById("searchBox").value.toLowerCase();
      const cat=document.getElementById("category").value;
      const mat=document.getElementById("material").value;
      const maxPrice=parseFloat(document.getElementById("priceRange").value);
      const filtered=allProducts.filter(p=>{
        const t=(p.title||"").toLowerCase();
        const d=(p.description||"").toLowerCase();
        const search=!q || t.includes(q) || d.includes(q);
        const categoryOk=!cat || p.category===cat;
        const materialOk=!mat || p.material===mat;
        const styleOk=!selectedStyle || p.style===selectedStyle;
        const colours=(p.colour||"").split(/[,/|;]/).map(s=>s.trim());
        const colourOk=selectedColours.size===0 || colours.some(c=>selectedColours.has(c));
        const priceVal=parseFloat(p.price);
        const priceOk=!isFinite(priceVal)?true:priceVal<=maxPrice;
        return search && categoryOk && materialOk && styleOk && colourOk && priceOk;
      });
      renderProducts(filtered);
    }

    async function loadProducts(){
      const res=await fetch(API_URL);
      const data=await res.json();
      allProducts=data.products||[];
      populateSelect("category",uniqueValues(allProducts,"category"));
      populateSelect("material",uniqueValues(allProducts,"material"));
      buildColourSwatches(uniqueValues(allProducts,"colour"));
      buildStyleCards(uniqueValues(allProducts,"style"));
      const max=Math.ceil(Math.max(...allProducts.map(p=>parseFloat(p.price)||0))/50)*50||2000;
      const pr=document.getElementById("priceRange");
      pr.max=max; pr.value=max;
      document.getElementById("priceValue").textContent=`¬£${max}`;
      renderProducts(allProducts);
    }

    document.getElementById("searchBox").addEventListener("input",applyFilters);
    document.getElementById("category").addEventListener("change",applyFilters);
    document.getElementById("material").addEventListener("change",applyFilters);
    document.getElementById("priceRange").addEventListener("input",e=>{
      document.getElementById("priceValue").textContent=`¬£${e.target.value}`;
      applyFilters();
    });
    document.getElementById("filterToggle").addEventListener("click",()=>{
      const f=document.getElementById("filters");
      f.classList.toggle("active");
      document.getElementById("filterToggle").textContent=f.classList.contains("active")?"Hide Filters ‚ñ≤":"Show Filters ‚¨áÔ∏è";
    });
    let showFav=false;
    document.getElementById("toggleFavourites").addEventListener("click",()=>{
      showFav=!showFav;
      const btn=document.getElementById("toggleFavourites");
      btn.textContent=showFav?"üîô View All Products":"‚≠ê View Favourites";
      if(showFav){
        const favSet=new Set(favourites);
        renderProducts(allProducts.filter(p=>favSet.has(p.title)));
      } else applyFilters();
    });
    loadProducts();
  </script>
</body>
</html>






