<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HomeInOn</title>
  <style>
    :root{
      --brand-accent:#F4A27B;
      --brand-bg:#FFF8F5;
      --ink:#2C2C2C;
      --muted:#6B6B6B;
      --card:#FFFFFF;
      --input-border:#dddddd;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
      --shadow-lg: 0 8px 24px rgba(0,0,0,0.15);
      --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      --caret-svg:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 6'><path fill='%23666' d='M1 0l4 4 4-4 1 1-5 5-5-5z'/></svg>");
    }

    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background:var(--brand-bg);
      color:var(--ink);
      line-height: 1.6;
    }

    /* ===== HEADER ===== */
    header{
      position:sticky; 
      top:0; 
      z-index:1000;
      background:rgba(255,255,255,0.95);
      backdrop-filter:saturate(1.2) blur(12px);
      -webkit-backdrop-filter:saturate(1.2) blur(12px);
      border-bottom:1px solid rgba(0,0,0,0.08);
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    .top-bar{
      display:flex; 
      justify-content:space-between; 
      align-items:center; 
      padding: 16px 24px;
      max-width: 1600px;
      margin: 0 auto;
    }
.header-buttons {
  display: flex;
  align-items: center;
  gap: 12px;
}

    .logo img{
      height:60px; 
      width:auto; 
      object-fit:contain;
      transition: transform 0.2s;
    }
    .logo img:hover{ transform: scale(1.02); }

    /* ===== BUTTONS ===== */
    button{
      background:var(--brand-accent); 
      color:#fff; 
      border:none; 
      border-radius:10px; 
      padding: 10px 20px; 
      font-weight:600; 
      font-size: 0.95rem;
      cursor:pointer; 
      transition: var(--transition);
      box-shadow: 0 2px 6px rgba(244, 162, 123, 0.3);
    }
    button:hover{
      background:#e18f6a;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(244, 162, 123, 0.4);
    }
    button:active{ transform: translateY(0); }

    .btn-outline{
      background:#fff; 
      color:var(--ink); 
      border:2px solid var(--input-border);
      box-shadow: none;
    }
    .btn-outline:hover{
      background: var(--brand-bg);
      border-color: var(--brand-accent);
      color: var(--brand-accent);
    }

    /* ===== STYLE SELECTOR ===== */
    .styles{ 
      display:flex; 
      gap:16px; 
      overflow-x:auto; 
      padding: 16px 24px; 
      scrollbar-width: thin;
      scrollbar-color: var(--brand-accent) transparent;
      mask-image: linear-gradient(to right, black 90%, transparent 100%);
      -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
    }
    .styles::-webkit-scrollbar { height: 6px; }
    .styles::-webkit-scrollbar-track { background: transparent; }
    .styles::-webkit-scrollbar-thumb { 
      background: var(--brand-accent); 
      border-radius: 10px; 
    }

    .style-card{ 
      min-width:140px; 
      height:120px; 
      border-radius:12px; 
      overflow:hidden; 
      position:relative; 
      cursor:pointer; 
      border:3px solid transparent; 
      flex:0 0 auto; 
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
    }
    .style-card:hover{
      transform: translateY(-4px) scale(1.02);
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .style-card img{
      width:100%; 
      height:100%; 
      object-fit:cover;
      transition: transform 0.3s;
    }
    .style-card:hover img{ transform: scale(1.08); }

    .style-card span{ 
      position:absolute; 
      bottom:0; 
      left:0; 
      right:0; 
      text-align:center; 
      color:#fff; 
      font-weight:700; 
      font-size: 0.9rem;
      text-shadow:0 1px 4px rgba(0,0,0,0.8); 
      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
      padding: 12px 8px 8px;
    }
    .style-card.active{
      border:3px solid var(--brand-accent); 
      transform: scale(1.05);
      box-shadow: 0 4px 16px rgba(244, 162, 123, 0.5);
    }

    /* ===== FILTER TOGGLE (Mobile) ===== */
    #filterToggle{ 
      display:none; 
      width:100%; 
      background:var(--brand-accent); 
      color:#fff; 
      border:none; 
      padding:14px; 
      cursor:pointer; 
      font-weight:700;
      font-size: 1rem;
    }

    /* ===== FILTERS ===== */
    .filters{ 
      display:grid; 
      grid-template-columns:repeat(6, minmax(160px,1fr)); 
      gap:20px; 
      padding: 20px 24px 24px; 
      align-items:end;
      max-width: 1600px;
      margin: 0 auto;
      background: rgba(255,255,255,0.5);
    }
    .filter-group{
      display:flex; 
      flex-direction:column; 
      gap:8px;
    }
    .filter-group label{
      font-size:0.85rem; 
      font-weight: 600;
      color:var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .filter-group select,
    .filter-group input[type="text"],
    .filter-group input[type="range"]{
      height:42px; 
      font-size:0.95rem;
      font-family: inherit;
    }

    .filter-group select,
    .filter-group input[type="text"]{
      padding: 0 40px 0 14px;
      border-radius:10px; 
      border:2px solid var(--input-border); 
      background:#fff;
      color:var(--ink);
      transition: var(--transition);
    }

    .filter-group select:focus,
    .filter-group input[type="text"]:focus{
      outline: none;
      border-color: var(--brand-accent);
      box-shadow: 0 0 0 3px rgba(244, 162, 123, 0.15);
    }

    .filter-group select{
      appearance:none; 
      -webkit-appearance:none; 
      -moz-appearance:none;
      background-image:var(--caret-svg);
      background-repeat:no-repeat;
      background-position:right 14px center;
      background-size:12px 8px;
      cursor: pointer;
    }

    /* ===== COLOUR DROPDOWN ===== */
    .colour-dropdown{position:relative}
    .colour-select{
      height:42px; 
      display:flex; 
      align-items:center;
      padding: 0 40px 0 14px; 
      border-radius:10px; 
      border:2px solid var(--input-border);
      background:#fff; 
      cursor:pointer; 
      font-size:0.95rem; 
      color:var(--ink);
      position:relative;
      background-image:var(--caret-svg);
      background-repeat:no-repeat;
      background-position:right 14px center;
      background-size:12px 8px;
      transition: var(--transition);
    }
    .colour-select:hover{
      border-color: var(--brand-accent);
    }
    .colour-list{
      display:none; 
      position:absolute; 
      top:calc(100% + 8px); 
      left:0; 
      right:0; 
      background:#fff;
      border:2px solid var(--input-border); 
      border-radius:10px; 
      box-shadow: var(--shadow-lg);
      max-height:260px; 
      overflow-y:auto; 
      z-index:100;
      animation: dropdownSlide 0.2s ease;
    }
    @keyframes dropdownSlide {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .colour-list.active{display:block}
    .colour-item{
      display:flex; 
      align-items:center; 
      gap:10px; 
      padding:12px 14px; 
      cursor:pointer;
      transition: background 0.15s;
    }
    .colour-item:hover{background:#f8f8f8}
    .colour-item:first-child{
      border-bottom: 1px solid #eee;
      font-weight: 600;
    }
    .swatch{
      width:20px; 
      height:20px; 
      border-radius:50%; 
      border:2px solid #ddd;
      flex-shrink: 0;
    }

    /* ===== PRODUCT LIST ===== */
    #product-count{
      margin: 24px 24px 16px; 
      font-weight:700;
      font-size: 1.1rem;
      color: var(--muted);
      max-width: 1600px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 24px;
    }

    #product-list{ 
      display: grid; 
      gap: 28px; 
      padding: 0 24px 40px; 
      grid-template-columns: repeat(auto-fill, minmax(280px, 340px));
      justify-content: center;
      max-width: 1600px;
      margin: 0 auto;
    }

    .product{ 
      background:#fff; 
      border-radius:16px; 
      box-shadow: var(--shadow-sm);
      overflow:hidden; 
      position:relative; 
      transition: var(--transition);
      cursor:pointer;
      display: flex;
      flex-direction: column;
    }
    .product:hover{
      transform: translateY(-6px);
      box-shadow: var(--shadow-lg);
    }

    .product img{
      width:100%; 
      height:280px; 
      object-fit:cover;
      transition: transform 0.4s;
    }
    .product:hover img{
      transform: scale(1.05);
    }

    .style-label{ 
      position:absolute; 
      top:12px; 
      right:12px; 
      background: rgba(244, 162, 123, 0.95);
      backdrop-filter: blur(8px);
      color:#fff; 
      padding:6px 12px; 
      border-radius:8px; 
      font-size:0.8rem; 
      font-weight:700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .product-info{
      padding:18px;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .product-info h3{
      font-size: 1.05rem;
      line-height: 1.4;
      color: var(--ink);
      font-weight: 600;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
.dims-badge{
  background: var(--brand-accent);
  color: #fff;
  display: inline-block;
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 0.85rem;
  font-weight: 600;
  letter-spacing: .2px;
  box-shadow: 0 2px 6px rgba(244,162,123,0.25);
}

.price {
  font-weight: 800;
  color: var(--ink);
  font-size: 1.15rem;
  margin-top: auto;
}

    /* ===== HEART BUTTONS ===== */
    .heart-btn{
      font-size:24px; 
      color:#ddd; 
      cursor:pointer; 
      transition: var(--transition);
      background:rgba(255,255,255,0.95); 
      backdrop-filter: blur(4px);
      border:none; 
      position:absolute; 
      bottom:14px; 
      right:14px;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .heart-btn:hover{
      transform:scale(1.2);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .heart-btn.liked{
      color:#e63946;
      background: rgba(230, 57, 70, 0.1);
    }
    @keyframes pulse{
      0%{transform:scale(1)}
      25%{transform:scale(1.4)}
      50%{transform:scale(1.2)}
      100%{transform:scale(1)}
    }
    .pulse{animation:pulse .35s ease}

    /* ===== MODAL ===== */
    .modal-overlay{ 
      position:fixed; 
      inset:0; 
      background:rgba(0,0,0,0.6); 
      backdrop-filter: blur(4px);
      display:none; 
      align-items:center; 
      justify-content:center; 
      z-index:2000;
      animation: fadeIn 0.2s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

.modal {
  width: min(1250px, 96vw);
  max-height: 100vh;
  overflow: auto;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  display: grid;
  grid-template-columns: 1.4fr 1fr;
  gap: 0;
  position: relative;
  animation: modalSlide 0.3s ease;
}
#roomsetModal .modal {
  display: block;
  width: min(1250px, 96vw);
  max-height: 90vh;
  overflow: hidden;
}

    @keyframes modalSlide {
      from { opacity: 0; transform: scale(0.95) translateY(20px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .modal .modal-img{ 
      background:#f8f8f8; 
      min-height:400px;
      position: relative;
      overflow: hidden;
    }
    .modal .modal-img img{ 
      width:100%; 
      height:100%; 
      object-fit:cover; 
      border-top-left-radius:20px; 
      border-bottom-left-radius:20px;
    }

 .modal .modal-body{ 
  padding:32px 28px 28px; 
  position:relative;
  overflow-y: auto;
  width: 100%;
  box-sizing: border-box;
}

    .modal h2{ 
      margin-bottom:12px; 
      padding-right:48px;
      font-size: 1.6rem;
      line-height: 1.3;
      color: var(--ink);
    }
    .modal .price-lg {
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--ink);
  margin-bottom: 16px;
}
.dims-line {
  display: inline-block;
  background: var(--brand-accent);
  color: #fff;
  border-radius: 10px;
  padding: 10px 14px;
  font-weight: 600;
  font-size: 0.9rem;
  margin: 6px 0 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

    .meta{
      display:grid; 
      grid-template-columns:1fr 1fr; 
      gap:12px; 
      margin:16px 0 20px;
    }
.meta div {
  background: var(--brand-accent);
  color: #fff;
  border: none;
  border-radius: 10px;
  padding: 14px;
  font-size: 0.9rem;
  line-height: 1.4;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: var(--transition);
}

.meta div strong {
  display: block;
  color: rgba(255,255,255,0.85);
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.meta div:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

    .desc{
      color:#555; 
      line-height:1.7; 
      margin:10px 0 20px;
      font-size: 0.95rem;
    }

    .btn-primary{ 
      background:var(--brand-accent); 
      color:#fff; 
      border:none; 
      border-radius:10px; 
      padding:12px 24px; 
      font-weight:700;
      font-size: 1rem;
      cursor:pointer;
      text-decoration: none;
      display: inline-block;
      transition: var(--transition);
      box-shadow: 0 4px 12px rgba(244, 162, 123, 0.3);
    }
    .btn-primary:hover{
      background: #e18f6a;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(244, 162, 123, 0.4);
    }

    .close-x{
      position:absolute; 
      top:16px; 
      right:16px;
      background:rgba(255,255,255,0.95); 
      color:#000;
      border:none;
      border-radius:50%; 
      width: 36px;
      height: 36px;
      cursor:pointer; 
      font-weight:800;
      font-size: 1.2rem;
      z-index:10;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .close-x:hover{
      background: #fff;
      transform: rotate(90deg) scale(1.1);
    }

    .modal-heart{
      position:absolute; 
      bottom:24px; 
      right:24px; 
      font-size:28px; 
      background:none; 
      border:none; 
      color:#ddd; 
      cursor:pointer;
      transition: var(--transition);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-heart:hover{
      transform: scale(1.2);
      background: rgba(0,0,0,0.05);
    }
    .modal-heart.liked{
      color:#e63946;
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width:1024px){
      .filters{
        grid-template-columns:repeat(3, 1fr);
      }
    }

    @media (max-width:768px){
      header{
        position:static; 
        backdrop-filter:none; 
        -webkit-backdrop-filter:none; 
        background:var(--card);
      }

      .header-buttons button {
        font-size: 0.75rem;
        padding: 6px 10px;
        border-radius: 6px;
        white-space: nowrap;
        line-height: 1;
        min-width: auto;
      }

      .header-buttons {
        gap: 6px;
        flex-wrap: nowrap;
      }
      
      .top-bar{
        padding: 12px 16px;
      }
      
      .logo img{ height: 50px; }
      
      .styles{
        padding:12px 16px;
        mask-image: linear-gradient(to right, black 85%, transparent 100%);
      }
      
      .style-card{
        min-width: 120px;
        height: 100px;
      }
      
      .filters{
        display:none; 
        grid-template-columns:1fr;
        padding: 16px;
      }
      .filters.active{display:grid}
      
      #filterToggle{display:block}
      
      #product-count{
        margin: 16px 16px 12px;
        padding: 0 16px;
      }
      
      #product-list{
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 20px;
        padding: 0 16px 30px;
      }
      
      .product img{
        height: 240px;
      }
      
      .modal{
        grid-template-columns:1fr;
        width: 96vw;
        max-height: 94vh;
      }
      .modal .modal-img img{
        border-radius:20px 20px 0 0;
        max-height: 350px;
      }
      .modal .modal-body{
        padding: 24px 20px 70px;
      }
      .meta{
        grid-template-columns: 1fr;
      }
    }

    @media (max-width:480px){
      #product-list{
        grid-template-columns: 1fr;
      }
    }
@media (max-width: 768px) {
  #filterToggle {
    margin-top: 8px;
  }
}

@media (max-width:768px){
  .product img{
    width: 100%;
    height: auto;
    aspect-ratio: 4 / 3;
    object-fit: cover;
  }
}

#filterToggle {
  background-image: var(--caret-svg);
  background-repeat: no-repeat;
  background-position: right 16px center;
  background-size: 12px 8px;
  text-align: left;
}

#filterToggle.active {
  transform: rotate(0);
}
.roomset-card {
  background: #fff;
  border-radius: 12px;
  box-shadow: var(--shadow-sm);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transition: var(--transition);
}
.roomset-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-md);
}
.roomset-card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
}
.roomset-card .info {
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.roomset-card .title {
  font-size: 0.95rem;
  color: var(--ink);
  font-weight: 600;
  line-height: 1.3;
}
.roomset-card .row {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.roomset-card .remove {
  background: #fff;
  color: #c0392b;
  border: 2px solid #f2d7d5;
  padding: 6px 10px;
  border-radius: 8px;
  font-weight: 700;
}
.roomset-card .remove:hover {
  background: #fdf2f2;
}
.roomset-item {
  position: absolute;
  width: 140px;
  height: 140px;
  background: transparent;
  box-shadow: none;
  border: none;
  overflow: visible;
  cursor: move;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s;
}

.roomset-item img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  background: transparent;
  border: none;
  box-shadow: none;
  mix-blend-mode: normal;
  pointer-events: none;
}

.roomset-item::after {
  content: "";
  position: absolute;
  bottom: 4px;
  left: 10%;
  right: 10%;
  height: 6px;
  background: rgba(0, 0, 0, 0.15);
  filter: blur(6px);
  border-radius: 50%;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s ease;
}
.roomset-item:hover::after {
  opacity: 1;
}

.roomset-item:active {
  transform: scale(1.05);
  z-index: 10;
}
.roomset-item .handle {
  position: absolute;
  z-index: 5;
  transition: transform 0.2s ease;
}

.roomset-item .resize-handle {
  position: absolute;
  bottom: -12px;
  right: -12px;
  width: 28px;
  height: 28px;
  border: 2px solid rgba(244,162,123,0.9);
  border-radius: 50%;
  background: #fff;
  box-shadow: 0 0 6px rgba(0,0,0,0.2);
  cursor: se-resize;
  display: flex;
  align-items: center;
  justify-content: center;
  touch-action: none;
  z-index: 10;
}

.roomset-item .resize-handle::after {
  content: "‚Üò";
  font-size: 14px;
  color: var(--brand-accent);
  font-weight: bold;
  pointer-events: none;
}

.roomset-item.rotating .rotate-handle {
  cursor: grabbing;
  background: #e18f6a;
  transform: translateX(-50%) scale(1.05);
}
.roomset-bg-selector {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding: 12px 0 16px;
  scrollbar-width: thin;
  scrollbar-color: var(--brand-accent) transparent;
  flex-wrap: nowrap;        /* üëà keep in one horizontal row */
  white-space: nowrap;      /* üëà avoid wrapping/squashing   */
}
.roomset-bg-thumb {
  width: 120px !important;
  height: 80px !important;
  flex: 0 0 120px !important;
  background-size: cover !important;
  background-position: center !important;
  border-radius: 8px;
  cursor: pointer;
  border: 3px solid transparent;
  box-shadow: var(--shadow-sm);
  transition: transform 0.2s, border-color 0.2s;
}
.roomset-bg-thumb:hover {
  transform: scale(1.05);
  border-color: var(--brand-accent);
}
.roomset-bg-thumb.active {
  border-color: var(--brand-accent);
  transform: scale(1.08);
  box-shadow: 0 4px 12px rgba(244,162,123,0.4);
}


.roomset-bg-selector::-webkit-scrollbar {
  height: 6px;
}
.roomset-bg-selector::-webkit-scrollbar-thumb {
  background: var(--brand-accent);
  border-radius: 10px;
}


/* ‚≠ê FIX MOBILE SQUASHING ‚Äî add this below the main block */
@media (max-width: 768px) {
  .roomset-bg-selector {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding: 10px 4px;
    scrollbar-width: thin;
  }

  .roomset-bg-selector img,
  .roomset-bg-selector #bgFloorplanOption {
    flex: 0 0 auto;        /* Prevents shrinking on mobile */
    width: 120px !important;
    height: 80px !important;
    object-fit: cover;
  }
}

#bgFloorplanOption {
  flex: 0 0 auto;            /* üëà don‚Äôt let this tile shrink */
}



/* ‚≠ê FLOORPLAN SPECIAL TILE (3D OPTION) */
#bgFloorplanOption:hover {
  transform: scale(1.05);
  border-color: var(--brand-accent);
}

#bgFloorplanOption.active {
  border-color: var(--brand-accent);
  transform: scale(1.08);
  box-shadow: 0 4px 12px rgba(244,162,123,0.4);
}

.roomset-bg-selector img:hover {
  transform: scale(1.05);
  border-color: var(--brand-accent);
}
.roomset-bg-selector img.active {
  border-color: var(--brand-accent);
  transform: scale(1.08);
  box-shadow: 0 4px 12px rgba(244,162,123,0.4);
}

#roomsetCanvas {
  position: relative;
  width: 100%;
  height: 600px;
  margin-top: 20px;
  background: #f8f8f8;
  border-radius: 12px;
  box-shadow: var(--shadow-sm);
  touch-action: none;
  overflow: visible;
  user-select: none;
}
.roomset-item, 
.roomset-item * {
  user-select: none;
  -webkit-user-drag: none;
}

#roomsetModal .modal-body {
  width: 100%;
  padding: 28px;
  box-sizing: border-box;
}

.roomset-buttons {
  display: flex;
  gap: 10px;
  margin-bottom: 16px;
  justify-content: flex-start;
}

.roomset-buttons .btn-primary {
  width: auto;
  padding: 10px 20px;
  font-weight: 700;
  flex: 0 0 auto;
  text-align: center;
}

.roomset-item img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  background: transparent;
  mix-blend-mode: multiply;
  filter: contrast(1.05) brightness(1.05);
  pointer-events: none;
  transition: transform 0.25s ease;
  border: none;
  box-shadow: none;
}

.roomset-item:hover img {
  transform: scale(1.02);
}

.roomset-item {
  position: absolute;
  z-index: 5;
  transition: transform 0.1s linear;
}
.roomset-item.rotating {
  z-index: 10;
}

@media (max-width: 768px) {
  #roomsetCanvas {
    height: 400px;
    border-width: 1.5px;
    overflow: visible;
    touch-action: none;
  }

.roomset-item {
  min-width: 60px;
  min-height: 60px;
}

  .roomset-item img {
    object-fit: contain;
  }

.roomset-item .resize-handle {
  bottom: -10px;
  right: -10px;
  width: 22px;
  height: 22px;
  border: 2px solid rgba(244,162,123,0.9);
  border-radius: 50%;
  background: #fff;
  box-shadow: 0 0 4px rgba(0,0,0,0.2);
  cursor: se-resize;
  display: flex;
  align-items: center;
  justify-content: center;
  touch-action: none;
  z-index: 10;
}

}
@media (max-width: 768px) {
  .top-bar {
    flex-direction: column;
    align-items: center;
    gap: 8px;
    text-align: center;
  }

  .logo img {
    height: 46px;
  }

  .header-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    width: 100%;
  }

  .header-buttons button {
    flex: 1 1 auto;
    min-width: 120px;
    text-align: center;
    font-size: 0.85rem;
    padding: 8px 12px;
  }

  .filters, #filterToggle {
    padding-left: 12px;
    padding-right: 12px;
  }
}
@media (max-width: 768px) {
  #roomsetList {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .roomset-item-list {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    background: #fff;
    border-radius: 12px;
    padding: 12px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.08);
    flex-wrap: wrap;
  }

  .roomset-item-list img {
    width: 80px;
    height: 80px;
    object-fit: contain;
    border-radius: 8px;
    flex-shrink: 0;
  }

  .roomset-item-info {
    flex: 1 1 100%;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .roomset-item-info h4 {
    font-size: 0.9rem;
    line-height: 1.3;
    color: var(--ink);
  }

  .roomset-item-info p {
    font-size: 0.8rem;
    color: var(--muted);
    margin: 0;
  }

  .roomset-remove-btn {
    display: block;
    width: 100%;
    margin-top: 8px;
    background: var(--brand-accent);
    color: #fff;
    border: none;
    border-radius: 10px;
    padding: 8px 0;
    font-size: 0.85rem;
    font-weight: 600;
    text-align: center;
    box-shadow: 0 2px 6px rgba(244,162,123,0.3);
    transition: var(--transition);
  }

  .roomset-remove-btn:hover {
    background: #e18f6a;
    transform: translateY(-1px);
  }
}
@media (min-width: 769px) {
  .roomset-item-list {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 12px;
    background: var(--brand-bg);
    border-radius: 10px;
    box-shadow: var(--shadow-sm);
  }

  .roomset-item-list img {
    width: 100px;
    height: 80px;
    object-fit: cover;
    border-radius: 8px;
  }

  .roomset-item-info {
    flex: 1;
  }

  .roomset-remove-btn {
    width: auto;
    margin-top: 0;
    background: #fff;
    color: #c0392b;
    border: 2px solid #f2d7d5;
    padding: 6px 10px;
    border-radius: 8px;
    font-weight: 700;
    box-shadow: none;
  }

  .roomset-remove-btn:hover {
    background: #fdf2f2;
    transform: none;
  }
}

/* ===== Roomset header layout ===== */
.roomset-header {
  margin-bottom: 16px;
}

.roomset-prompt-row {
  margin-bottom: 10px;
}

.roomset-input {
  width: 100%;
  padding: 12px 14px;
  border-radius: 10px;
  border: 2px solid var(--input-border);
  font-size: 0.95rem;
}

.roomset-controls-row {
  display: flex;
  justify-content: flex-start;  /* üëà align buttons to the left */
  gap: 12px;
  flex-wrap: wrap;
}


.roomset-controls-row .top-btn,
.roomset-controls-row .suggest-btn {
  background: var(--brand-accent);
  color: #fff;
  border: none;
  border-radius: 10px;
  padding: 10px 24px;
  font-weight: 700;
  font-size: 0.95rem;
  cursor: pointer;
  box-shadow: 0 3px 8px rgba(244,162,123,0.35);
}

@media (max-width: 768px) {
  .roomset-controls-row {
    flex-direction: column;
  }
  .roomset-controls-row button {
    width: 100%;
  }
}

/* ===== 3D FLOORPLAN OVERLAY ===== */
.floorplan-overlay {
  position: absolute;
  inset: 16px;
  pointer-events: none;
  font-size: 0.85rem;
  color: var(--ink);
}

.floorplan-label-center {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  background: rgba(255,255,255,0.85);
  padding: 8px 14px;
  border-radius: 10px;
  text-align: center;
  box-shadow: var(--shadow-sm);
}

.floorplan-area {
  color: var(--muted);
  font-size: 0.8rem;
}

.floorplan-dim {
  position: absolute;
  background: rgba(255,255,255,0.85);
  padding: 4px 8px;
  border-radius: 8px;
  box-shadow: var(--shadow-sm);
}

.floorplan-dim-top {
  top: 0;
  left: 50%;
  transform: translate(-50%, -50%);
}

.floorplan-dim-right {
  right: 0;
  top: 50%;
  transform: translate(50%, -50%) rotate(90deg);
}
/* --- FIX MOBILE ROOMSET THUMBNAIL SQUASHING --- */
@media (max-width: 768px) {
  .roomset-bg-selector img,
  #bgFloorplanOption {
    width: 120px !important;
    height: 80px !important;
    flex: 0 0 auto !important;
    object-fit: cover !important;
  }

  .roomset-bg-selector {
    flex-wrap: nowrap !important;
    white-space: nowrap !important;
    overflow-x: auto !important;
  }
}

  </style>
</head>
<body>
  <header>
<div class="top-bar">
  <div class="logo"><img src="Home-in-on-logo.webp" alt="HomeInOn Logo"></div>

  <div class="header-buttons">
    <button id="toggleFavourites">‚≠ê View Favourites</button>
    <button id="toggleRoomset">ü™Ñ View Roomset</button>
  </div>
</div>

<div class="styles" id="roomSelector"></div>
    <div class="styles" id="styleSelector"></div>

   <button id="filterToggle">Show Filters ‚ñº</button>

    <section class="filters" id="filters">
      <div class="filter-group">
        <label for="searchBox">Search</label>
        <input type="text" id="searchBox" placeholder="e.g. oak table, mirror, sofa‚Ä¶"/>
      </div>

      <div class="filter-group">
        <label for="category">Category</label>
        <select id="category"><option value="">All</option></select>
      </div>

      <div class="filter-group">
        <label for="material">Material</label>
        <select id="material"><option value="">All</option></select>
      </div>

      <div class="filter-group colour-dropdown">
        <label for="colourSelect">Colour</label>
        <div id="colourSelect" class="colour-select">All</div>
        <div id="colourList" class="colour-list"></div>
      </div>

      <div class="filter-group">
        <label for="priceRange">Max Price (¬£)</label>
        <input type="range" id="priceRange" min="0" max="2000" step="10" value="2000"/>
        <span id="priceValue">¬£2000</span>
      </div>

      <div class="filter-group">
        <label>&nbsp;</label>
        <button id="clearFilters" class="btn-outline">Clear filters</button>
      </div>
    </section>
  </header>

  <p id="product-count"></p>
  <div id="product-list"></div>

  <div id="productModal" class="modal-overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <button class="close-x" id="modalClose" aria-label="Close">‚úï</button>
      <div class="modal-img"><img id="modalImage" alt="Product image"/></div>
      <div class="modal-body">
        <h2 id="modalTitle">Title</h2>
<div class="price-lg" id="modalPrice">¬£0.00</div>

<div class="meta">
  <div><strong>Category:</strong> <span id="modalCategory">‚Äî</span></div>
  <div><strong>Material:</strong> <span id="modalMaterial">‚Äî</span></div>
  <div><strong>Colour:</strong> <span id="modalColour">‚Äî</span></div>
  <div><strong>Style:</strong> <span id="modalStyle">‚Äî</span></div>
  <div><strong>Room:</strong> <span id="modalRoom">‚Äî</span></div>
  <div><strong>DIMENSIONS:</strong> <span id="modalDimsText">‚Äî</span></div>
</div>

<div class="desc" id="modalDescription">Description here‚Ä¶</div>

<div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px;">
  <a id="modalLink" class="btn-primary" href="#" target="_blank" rel="noopener" style="display:none">View product</a>
  <button id="modalRoomsetBtn" class="btn-outline">Ôºã Add to Roomset</button>
</div>

<button id="modalHeart" class="modal-heart" title="Favourite">‚ù§</button>
</div>
</div>
</div>

<div id="roomsetModal" class="modal-overlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true">
    
    <button class="close-x" id="roomsetClose" aria-label="Close">‚úï</button>

    <div class="modal-body" style="padding:28px; max-height:90vh; overflow:auto;">

<!-- TOP AREA -->
<div class="roomset-header">

  <div class="roomset-prompt-row">
    <input
      id="roomsetPrompt"
      type="text"
      placeholder="Describe your room (e.g. blue bedroom with a bed, wardrobe and mirror under ¬£1000)‚Ä¶"
      class="roomset-input"
    />
  </div>

  <!-- Only ONE status element -->
  <div id="roomsetSuggestStatus"
       style="margin-top:6px; color:#888; font-size:14px;">
    AI loading‚Ä¶
  </div>

  <div class="roomset-controls-row">
      <button id="viewListBtn" class="top-btn">üìã List View</button>
      <button id="viewCanvasBtn" class="top-btn">üñºÔ∏è Canvas View</button>
      <button id="roomsetSuggestBtn" class="suggest-btn">‚ú® Suggest items</button>
  </div>

  <!-- Output (keep only this, do NOT add another status here) -->
  <div id="roomsetSuggestOutput"
       style="margin-top:8px; font-size:0.9rem; white-space:pre-wrap;">
  </div>

</div>



<!-- 3D FLOORPLAN ENTRY -->
<div class="roomset-bg-selector" style="margin-bottom: 14px;">

</div>


<!-- Background thumbnail strip (JS fills these automatically + adds floorplan tile) -->
<div id="roomsetBackgrounds" class="roomset-bg-selector">
  
  <!-- 3D Floorplan button ‚Äî MUST stay INSIDE the strip -->
  <div id="bgFloorplanOption"
       style="
         width:120px;
         height:80px;
         border-radius:8px;
         background:#e8e8e8;
         display:flex;
         align-items:center;
         justify-content:center;
         font-weight:700;
         color:#555;
         cursor:pointer;
         border:3px solid transparent;
         box-shadow: var(--shadow-sm);
       ">
    üìê 3D Floorplan
  </div>

</div>



      <div id="roomsetCanvas"
        style="display:none; min-height:500px; border:2px dashed #ddd; border-radius:12px; background:#fafafa; position:relative;">
      </div>

      <div id="roomsetList"
           style="display:grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap:16px;">
      </div>

      <div style="margin-top:16px; text-align:left;">
        <button id="roomsetClear" class="btn-primary">Clear Roomset</button>
      </div>

    </div>
  </div>
</div>
<!-- FLOORPLAN DIMENSIONS MODAL -->
<div id="floorplanDimPopup" class="modal-overlay" style="display:none;">
  <div class="modal" style="max-width:480px; padding:20px;">

    <button class="close-x" id="closeFloorplanDims">‚úï</button>

    <div class="modal-body">

      <h2 style="margin-bottom:15px;">Room Dimensions</h2>

      <label>Width (m)</label>
      <input id="fpWidth" type="number" min="1" value="3" 
             style="width:100%; padding:10px; margin-bottom:10px;">

      <label>Depth (m)</label>
      <input id="fpDepth" type="number" min="1" value="3" 
             style="width:100%; padding:10px; margin-bottom:10px;">

      <label>Wall Height (m)</label>
      <input id="fpHeight" type="number" min="2" value="2.4" 
             style="width:100%; padding:10px; margin-bottom:20px;">

      <button id="createFloorplan" class="btn-primary" style="width:100%;">Generate Floorplan</button>

    </div>
  </div>
</div>


<!-- 3D VIEWER -->
<div id="threeContainer" style="
  width: 100%;
  max-width: 1200px;
  height: 520px;
  margin: 30px auto;
  border-radius: 12px;
  background: #f7f7f7;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  position: relative;
  overflow: hidden;
"></div>

<!-- Load THREE.js -->
<script type="module">
  import * as THREE from "https://esm.sh/three@0.160.0";
  import { OrbitControls } from "https://esm.sh/three@0.160.0/examples/jsm/controls/OrbitControls.js";
  import { GLTFLoader } from "https://esm.sh/three@0.160.0/examples/jsm/loaders/GLTFLoader.js";
  import { DRACOLoader } from "https://esm.sh/three@0.160.0/examples/jsm/loaders/DRACOLoader.js";

  window.THREE = THREE;
  window.OrbitControls = OrbitControls;
  window.GLTFLoader = GLTFLoader;
  window.DRACOLoader = DRACOLoader;
</script>

<!-- Load WebLLM (fallback CDN that ALWAYS works) -->
<script src="https://unpkg.com/@mlc-ai/web-llm@latest/dist/index.bundle.js"></script>

<!-- Load your app -->
<script src="/script.js"></script>


<script>
// OPEN DIMENSION POPUP WHEN CLICKING THE BIG ORANGE BOX
document.addEventListener("DOMContentLoaded", () => {
  const btn1 = document.getElementById("floorplanBtn");
  const btn2 = document.getElementById("bgFloorplanOption");
  const popup = document.getElementById("floorplanDimPopup");

  if (btn1) btn1.addEventListener("click", () => popup.style.display = "flex");
  if (btn2) btn2.addEventListener("click", () => popup.style.display = "flex");
});
</script>

<script>
// STEP 3 ‚Äî Create 3D Floorplan from Dimensions
document.addEventListener("DOMContentLoaded", () => {
  const createBtn = document.getElementById("createFloorplan");
  const fpPopup = document.getElementById("floorplanDimPopup");

  createBtn.addEventListener("click", () => {
    const width = parseFloat(document.getElementById("fpWidth").value);
    const depth = parseFloat(document.getElementById("fpDepth").value);
    const height = parseFloat(document.getElementById("fpHeight").value);

    // Close popup
    fpPopup.style.display = "none";

    // Switch to Canvas View automatically
    document.getElementById("viewCanvasBtn").click();

    // Render floorplan room
    generateFloorplanRoom(width, depth, height);
  });
});

// ----------------------------------------------------------
// FUNCTION: Generate 3D room inside #roomsetCanvas
// ----------------------------------------------------------
function generateFloorplanRoom(widthM, depthM, heightM) {
  const container = document.getElementById("roomsetCanvas");

  // Clear previous drawings
  container.innerHTML = "";

  // Convert meters ‚Üí pixels (simple ratio)
  const scale = 120;  // 1 meter = 120 pixels

  const W = widthM * scale;
  const D = depthM * scale;
  const H = heightM * scale;

  // Create SVG-based 3D illusion (fast, light)
  const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  svg.setAttribute("width", "100%");
  svg.setAttribute("height", "100%");
  svg.style.position = "absolute";
  svg.style.top = "0";
  svg.style.left = "0";

  // FLOOR
  const floor = document.createElementNS(svg.namespaceURI, "rect");
  floor.setAttribute("id", "floorRect");
  floor.setAttribute("x", (container.clientWidth - W) / 2);
  floor.setAttribute("y", (container.clientHeight - (D / 2)) / 2);
  floor.setAttribute("width", W);
  floor.setAttribute("height", D / 2);
  floor.setAttribute("fill", "#dcdcdc");
  floor.setAttribute("stroke", "#999");
  floor.setAttribute("stroke-width", "3");
  floor.style.opacity = 0.9;

  // BACK WALL
  const backWall = document.createElementNS(svg.namespaceURI, "rect");
  backWall.setAttribute("id", "backWallRect");
  backWall.setAttribute("x", (container.clientWidth - W) / 2);
  backWall.setAttribute("y", (container.clientHeight - (D / 2)) / 2 - H);
  backWall.setAttribute("width", W);
  backWall.setAttribute("height", H);
  backWall.setAttribute("fill", "#f5f5f5");
  backWall.setAttribute("stroke", "#aaa");
  backWall.setAttribute("stroke-width", "3");

  // LEFT WALL
  const leftWall = document.createElementNS(svg.namespaceURI, "polygon");
  const lx = (container.clientWidth - W) / 2;
  const ly = (container.clientHeight - (D / 2)) / 2;
  const leftPoints = `
    ${lx},${ly} 
    ${lx},${ly - H}
    ${lx - (D / 3)},${ly - H + (D / 3)} 
    ${lx - (D / 3)},${ly + (D / 3)}
  `;
  leftWall.setAttribute("points", leftPoints);
  leftWall.setAttribute("fill", "#efefef");
  leftWall.setAttribute("stroke", "#bbb");
  leftWall.setAttribute("stroke-width", "3");

  // RIGHT WALL
  const rightWall = document.createElementNS(svg.namespaceURI, "polygon");
  const rx = (container.clientWidth + W) / 2;
  const rightPoints = `
    ${rx},${ly} 
    ${rx},${ly - H}
    ${rx + (D / 3)},${ly - H + (D / 3)} 
    ${rx + (D / 3)},${ly + (D / 3)}
  `;
  rightWall.setAttribute("points", rightPoints);
  rightWall.setAttribute("fill", "#efefef");
  rightWall.setAttribute("stroke", "#bbb");
  rightWall.setAttribute("stroke-width", "3");

  // Append in correct stacking order
  svg.appendChild(backWall);
  svg.appendChild(leftWall);
  svg.appendChild(rightWall);
  svg.appendChild(floor);

  container.appendChild(svg);
}
</script>
<script>
// STEP 4 ‚Äî Add Roomset Items Into 3D Floorplan Room

// This function will be called instead of the normal 2D canvas placement
// whenever the 3D room exists.
function addItemTo3DRoom(itemData) {
  const container = document.getElementById("roomsetCanvas");
  const svg = container.querySelector("svg");
  if (!svg) {
    alert("You must generate a 3D room before adding items!");
    return;
  }

  // Convert item dimensions (cm ‚Üí px)
  const scale = 1.2; // 1cm = 1.2px simple ratio
  const w = (itemData.width || 80) * scale;
  const h = (itemData.height || 80) * scale;

  // Floor position
  const floorY = parseFloat(svg.querySelector("rect").getAttribute("y"));
  const centerX = container.clientWidth / 2;

  // Create furniture image inside the SVG
const img = document.createElementNS("http://www.w3.org/2000/svg", "image");
img.setAttribute("href", itemData.image);
img.setAttribute("width", w);
img.setAttribute("height", h);

// üëá Add these
img.originalWidth = w;
img.originalHeight = h;


  // Start on floor, centered
  img.setAttribute("x", centerX - w / 2);
  img.setAttribute("y", floorY - h);

  img.style.cursor = "pointer";
  img.style.transition = "0.15s";

  svg.appendChild(img);
}


// --------------------------------------------------------------------------
// OVERRIDE: When user adds product to roomset, send to 3D placement if enabled
// --------------------------------------------------------------------------
document.addEventListener("DOMContentLoaded", () => {
  const addBtn = document.getElementById("modalRoomsetBtn");

  addBtn.addEventListener("click", () => {
    // Read current product from modal
    const item = {
      title: document.getElementById("modalTitle").innerText,
      image: document.getElementById("modalImage").src,
      width: extractNumber(document.getElementById("modalDimsText").innerText, 0),
      height: extractNumber(document.getElementById("modalDimsText").innerText, 1),
      depth: extractNumber(document.getElementById("modalDimsText").innerText, 2),
    };

    // If 3D canvas exists ‚Üí place item in 3D
    const canvas = document.getElementById("roomsetCanvas");
    const has3DRoom = canvas.querySelector("svg");

    if (has3DRoom) {
      addItemTo3DRoom(item);
    } else {
      // fallback: standard 2D placement (your existing JS handles this)
      console.log("No 3D room yet ‚Äî adding item using 2D system");
    }

    document.getElementById("productModal").style.display = "none";
  });
});


// Helper: Extract dims like "120 x 80 x 60 cm"
function extractNumber(dimText, index) {
  if (!dimText) return 80;

  const nums = dimText.match(/\d+/g);
  if (!nums || nums.length < 3) return 80;

  return parseFloat(nums[index]);
}
</script>
<script>
// STEP 5+6 ‚Äî Drag, depth-scale, z-ordering, wall snapping
document.addEventListener("DOMContentLoaded", () => {
  const canvas = document.getElementById("roomsetCanvas");
  if (!canvas) return;

  let selected = null;
  let offsetX = 0;
  let offsetY = 0;

  canvas.addEventListener("mousedown", startDrag);
  canvas.addEventListener("touchstart", startDrag, { passive: false });

  function startDrag(e) {
    const svg = canvas.querySelector("svg");
    if (!svg) return;

    const target = e.target.closest("image");
    if (!target) return;

    selected = target;

    const rect = canvas.getBoundingClientRect();
    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;

    const curX = parseFloat(selected.getAttribute("x")) || 0;
    const curY = parseFloat(selected.getAttribute("y")) || 0;

    offsetX = clientX - rect.left - curX;
    offsetY = clientY - rect.top - curY;

    // Bring item to front
    svg.appendChild(selected);

    document.addEventListener("mousemove", drag);
    document.addEventListener("mouseup", endDrag);
    document.addEventListener("touchmove", drag, { passive: false });
    document.addEventListener("touchend", endDrag);
  }

  function drag(e) {
    if (!selected) return;
    e.preventDefault();

    const svg = canvas.querySelector("svg");
    const rect = canvas.getBoundingClientRect();

    const floorRect = svg.querySelector("#floorRect");
    if (!floorRect) return;

    const floorY = parseFloat(floorRect.getAttribute("y"));

    const baseW = selected.originalWidth || selected.width.baseVal.value;
    const baseH = selected.originalHeight || selected.height.baseVal.value;

    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;

    let newX = clientX - rect.left - offsetX;
    let newY = clientY - rect.top - offsetY;

    if (newY > floorY - baseH) {
      newY = floorY - baseH;
    }

    const depthRange = floorY - 40;
    const depthFactor = 1 - (newY / depthRange);
    const scale = Math.max(0.45, Math.min(1.2, depthFactor));

    selected.setAttribute("x", newX);
    selected.setAttribute("y", newY);
    selected.setAttribute("width", baseW * scale);
    selected.setAttribute("height", baseH * scale);
  }

  function endDrag() {
    if (!selected) {
      cleanup();
      return;
    }

    const svg = canvas.querySelector("svg");
    const backWall = svg.querySelector("#backWallRect");

    if (backWall) {
      const backY = parseFloat(backWall.getAttribute("y"));
      const y = parseFloat(selected.getAttribute("y"));

      if (y < backY + 30) {
        selected.setAttribute("y", backY + 10);
      }
    }

    const items = [...svg.querySelectorAll("image")];
    items
      .sort((a, b) => {
        const ay = parseFloat(a.getAttribute("y"));
        const by = parseFloat(b.getAttribute("y"));
        return ay - by;
      })
      .forEach((img) => svg.appendChild(img));

    selected = null;
    cleanup();
  }

  function cleanup() {
    document.removeEventListener("mousemove", drag);
    document.removeEventListener("mouseup", endDrag);
    document.removeEventListener("touchmove", drag);
    document.removeEventListener("touchend", endDrag);
  }
});
</script>
<script>
// STEP 6 ‚Äî Make 3D Floorplan behave like a selectable background option
document.addEventListener("DOMContentLoaded", () => {
  const fpTile = document.getElementById("bgFloorplanOption");
  const backgrounds = document.getElementById("roomsetBackgrounds");
  const canvas = document.getElementById("roomsetCanvas");

  if (!fpTile) return;

  // When clicked ‚Üí mark active & show popup
  fpTile.addEventListener("click", () => {
    // Remove active class from ALL background thumbnails
    backgrounds.querySelectorAll("img, div").forEach(el => {
      el.classList.remove("active");
    });

    // Make Floorplan thumbnail active
    fpTile.classList.add("active");

    // Open the popup (dimensions modal)
    document.getElementById("floorplanDimPopup").style.display = "flex";
  });

  // When floorplan is created, the 3D room becomes the background
  document.getElementById("createFloorplan").addEventListener("click", () => {
    // Switch to canvas view automatically
    document.getElementById("viewCanvasBtn").click();

    // Clear any OLD 2D background image (if exists)
    canvas.style.backgroundImage = "none";
    canvas.style.backgroundSize = "contain";
    canvas.style.backgroundRepeat = "no-repeat";

    // Also clear previously rendered SVG for safety
    const oldSVG = canvas.querySelector("svg");
    if (oldSVG) oldSVG.remove();
  });
});
</script>



</body>
</html>
